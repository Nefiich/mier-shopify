{% comment %}
  Collection Slider Section - Split Layout
  - Left: Fixed title (50% width, full height)
  - Right: Scrollable product grid (50% width each item)
{% endcomment %}

<div id="section-{{ section.id }}" class="collection-slider-split">
  
  <div class="split-container">
    
    <!-- Left Side: Fixed Title -->
    <div class="split-left">
      <div class="title-container">
        <h2 class="title h1">{{ section.settings.collection_title }}</h2>
      </div>
    </div>

    <!-- Right Side: Scrollable Products -->
    <div class="split-right">
      <div class="products-scroll-container">
        
        {% if section.settings.collection != blank %}
          {% assign collection = collections[section.settings.collection] %}
          {% assign product_limit = section.settings.products_to_show %}
          
          {% for product in collection.products limit: product_limit %}
            <div class="product-item-wrapper">
              <div class="product-item" data-handle="{{ product.handle }}">

                <a href="{{ product.url }}" 
                   title="{{ product.title }}" 
                   class="product-link">
                  
                  {%- if product.featured_image -%}
                    <div class="product-images">
                      <div class="image-primary">
                        <img src="{{ product.featured_image | img_url: '800x' }}" 
                             alt="{{ product.title }}"
                             srcset="{{ product.featured_image | img_url: '400x' }} 400w,
                                     {{ product.featured_image | img_url: '600x' }} 600w,
                                     {{ product.featured_image | img_url: '800x' }} 800w,
                                     {{ product.featured_image | img_url: '1000x' }} 1000w"
                             sizes="50vw"
                             loading="lazy">
                      </div>
                      
                      {%- if product.images[1] -%}
                        <div class="image-secondary">
                          <img src="{{ product.images[1] | img_url: '800x' }}" 
                               alt="{{ product.title }}"
                               srcset="{{ product.images[1] | img_url: '400x' }} 400w,
                                       {{ product.images[1] | img_url: '600x' }} 600w,
                                       {{ product.images[1] | img_url: '800x' }} 800w,
                                       {{ product.images[1] | img_url: '1000x' }} 1000w"
                               sizes="50vw"
                               loading="lazy">
                        </div>
                      {%- endif -%}
                    </div>
                  {%- endif -%}

                  <div class="product-info">
                    <h3 class="product-title">{{ product.title }}</h3>
                    <div class="product-price">
                      {% if product.compare_at_price > product.price %}
                        <span class="price-sale">{{ product.price | money }}</span>
                        <del class="price-compare">{{ product.compare_at_price | money }}</del>
                      {% else %}
                        <span class="price-regular">{{ product.price | money }}</span>
                      {% endif %}
                    </div>
                    
                    {%- if product.metafields.reviews.rating.value -%}
                      <div class="product-rating">
                        <span class="rating-value">{{ product.metafields.reviews.rating.value }} / 5</span>
                        <span class="rating-icon">â˜…</span>
                      </div>
                    {%- endif -%}
                  </div>
                  
                </a>

              </div>
            </div>
          {% endfor %}
          
        {% else %}
          <div class="empty-state">
            <p>Please select a collection in the theme editor.</p>
          </div>
        {% endif %}

      </div>
    </div>

  </div>

</div>

<style>
  #section-{{ section.id }}.collection-slider-split {
    width: 100%;
    min-height: 100vh;
    position: relative;
  }

  #section-{{ section.id }} .split-container {
    display: flex;
    width: 100%;
    min-height: 100vh;
  }

  /* LEFT SIDE - FIXED TITLE */
  #section-{{ section.id }} .split-left {
    width: 50%;
    position: sticky;
    top: 0;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f8f8f8;
    padding: 2rem;
  }

  #section-{{ section.id }} .title-container {
    text-align: center;
  }

  #section-{{ section.id }} .title {
    font-size: clamp(3rem, 8vw, 6rem);
    font-weight: 700;
    letter-spacing: 0.02em;
    margin: 0;
    text-transform: uppercase;
  }

  /* RIGHT SIDE - SCROLLABLE PRODUCTS */
  #section-{{ section.id }} .split-right {
    width: 50%;
    display: flex;
    flex-direction: column;
  }

  #section-{{ section.id }} .products-scroll-container {
    display: flex;
    flex-direction: column;
    width: 100%;
  }

  #section-{{ section.id }} .product-item-wrapper {
    width: 100%;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    box-sizing: border-box;
  }

  #section-{{ section.id }} .product-item {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
  }

  #section-{{ section.id }} .product-link {
    display: flex;
    flex-direction: column;
    height: 100%;
    text-decoration: none;
    color: inherit;
  }

  #section-{{ section.id }} .product-images {
    position: relative;
    flex: 1;
    overflow: hidden;
    background: #fafafa;
  }

  #section-{{ section.id }} .image-primary,
  #section-{{ section.id }} .image-secondary {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    transition: opacity 0.3s ease;
  }

  #section-{{ section.id }} .image-secondary {
    opacity: 0;
  }

  #section-{{ section.id }} .product-link:hover .image-secondary {
    opacity: 1;
  }

  #section-{{ section.id }} .product-images img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  #section-{{ section.id }} .product-info {
    padding: 1.5rem 0;
    text-align: center;
  }

  #section-{{ section.id }} .product-title {
    font-size: 1.25rem;
    font-weight: 600;
    margin: 0 0 0.5rem 0;
    text-transform: uppercase;
  }

  #section-{{ section.id }} .product-price {
    font-size: 1rem;
    margin-bottom: 0.5rem;
  }

  #section-{{ section.id }} .price-sale {
    color: #e74c3c;
    font-weight: 600;
    margin-right: 0.5rem;
  }

  #section-{{ section.id }} .price-compare {
    color: #999;
    font-size: 0.9rem;
  }

  #section-{{ section.id }} .product-rating {
    font-size: 0.875rem;
    color: #666;
  }

  #section-{{ section.id }} .rating-icon {
    color: #ffc107;
    margin-left: 0.25rem;
  }

  #section-{{ section.id }} .empty-state {
    width: 100%;
    height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    padding: 2rem;
  }

  /* RESPONSIVE */
  @media screen and (max-width: 768px) {
    #section-{{ section.id }} .split-container {
      flex-direction: column;
    }

    #section-{{ section.id }} .split-left {
      width: 100%;
      height: 50vh;
      position: relative;
    }

    #section-{{ section.id }} .split-right {
      width: 100%;
    }

    #section-{{ section.id }} .product-item-wrapper {
      height: 80vh;
    }
  }
</style>

{% schema %}
{
  "name": "Collection Slider Split",
  "settings": [
    {
      "type": "text",
      "id": "collection_title",
      "label": "Collection Title",
      "default": "KIDS"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "min": 3,
      "max": 20,
      "step": 1,
      "label": "Products to Show",
      "default": 6
    }
  ],
  "presets": [
    {
      "name": "Collection Slider Split"
    }
  ]
}
{% endschema %}